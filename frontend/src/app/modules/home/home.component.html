<div class="modal-group">
  <app-modal
    [(visibility)]="isAddFundsModalVisible"
    [title]="'Add Fund'"
  >
    <div>
      <mat-form-field style="width: 100%" appearance="outline">
        <mat-label>Amount Gained</mat-label>
        <input
          matInput
          [formControl]="formValue"
          type="number"
          autocomplete="off"
          placeholder="10000"
        />
      </mat-form-field>

      <mat-form-field style="width: 100%" appearance="outline">
        <mat-label>Choose a date</mat-label>
        <input matInput [matDatepicker]="picker1" [formControl]="formCreatedOn">
        <mat-datepicker-toggle matSuffix [for]="picker1"></mat-datepicker-toggle>
        <mat-datepicker #picker1></mat-datepicker>
      </mat-form-field>

      <mat-form-field style="width: 100%" appearance="outline">
        <mat-label>Category</mat-label>
        <mat-select [formControl]="formCategory">
          <mat-option *ngFor="let incomeType of incomeTypesList" [value]="incomeType">
            {{incomeType}}
          </mat-option>
        </mat-select>
      </mat-form-field>
      <div style="display: flex">
        <button
          color="primary"
          style="width: 100%; margin-right: 3px"
          mat-stroked-button
          (click)="closeAddFundsModal()"
        >
          CANCEL
        </button>
        <button
          color="primary"
          style="width: 100%; margin-right: 3px"
          mat-flat-button
          (click)="onSubmitCreateFundsForm()"
        >
          CONFIRM
        </button>
      </div>
    </div>
  </app-modal>

  <app-modal
    [(visibility)]="isAddExpenseModalVisible"
    [title]="'Add Expense'"
  >
    <div>
      <mat-form-field style="width: 100%" appearance="outline">
        <mat-label>What did you buy?</mat-label>
        <input
          matInput
          [formControl]="formDescription"
          type="text"
          autocomplete="off"
          placeholder="Raspberry Pi 4"
        />
      </mat-form-field>

      <mat-form-field style="width: 100%" appearance="outline">
        <mat-label>Amount Spent</mat-label>
        <input
          matInput
          [formControl]="formValue"
          type="number"
          autocomplete="off"
          placeholder="10000"
        />
      </mat-form-field>

      <mat-form-field style="width: 100%" appearance="outline">
        <mat-label>Choose a date</mat-label>
        <input matInput [matDatepicker]="picker2" [formControl]="formCreatedOn">
        <mat-datepicker-toggle matSuffix [for]="picker2"></mat-datepicker-toggle>
        <mat-datepicker #picker2></mat-datepicker>
      </mat-form-field>

      <mat-form-field style="width: 100%" appearance="outline">
        <mat-label>Category</mat-label>
        <mat-select [formControl]="formCategory">
          <mat-option *ngFor="let expenseType of expenseTypesList" [value]="expenseType">
            {{expenseType}}
          </mat-option>
        </mat-select>
      </mat-form-field>
      <div style="display: flex">
        <button
          color="primary"
          style="width: 100%; margin-right: 3px"
          mat-stroked-button
          (click)="closeAddExpenseModal()"
        >
          CANCEL
        </button>
        <button
          color="primary"
          style="width: 100%; margin-right: 3px"
          mat-flat-button
          (click)="onSubmitCreateExpenseForm()"
        >
          CONFIRM
        </button>
      </div>
    </div>
  </app-modal>

  <app-modal
    [(visibility)]="isAddDueModalVisible"
    [title]="'Add Due'"
  >
    <div>
      <mat-form-field style="width: 100%" appearance="outline">
        <mat-label>Describe the Due?</mat-label>
        <input
          matInput
          [formControl]="formDescription"
          type="text"
          autocomplete="off"
          placeholder="Lol Idk"
        />
      </mat-form-field>

      <mat-form-field style="width: 100%" appearance="outline">
        <mat-label>Amount Due</mat-label>
        <input
          matInput
          [formControl]="formValue"
          type="number"
          autocomplete="off"
          placeholder="500"
        />
      </mat-form-field>

      <mat-form-field style="width: 100%" appearance="outline">
        <mat-label>Choose a date</mat-label>
        <input matInput [matDatepicker]="picker3" [formControl]="formCreatedOn">
        <mat-datepicker-toggle matSuffix [for]="picker3"></mat-datepicker-toggle>
        <mat-datepicker #picker3></mat-datepicker>
      </mat-form-field>

      <div style="display: flex">
        <button
          color="primary"
          style="width: 100%; margin-right: 3px"
          mat-stroked-button
          (click)="closeAddDueModal()"
        >
          CANCEL
        </button>
        <button
          color="primary"
          style="width: 100%; margin-right: 3px"
          mat-flat-button
          (click)="onSubmitCreateDueForm()"
        >
          CONFIRM
        </button>
      </div>
    </div>
  </app-modal>
</div>

<div class="root">
  <img
    src="assets/default-monochrome.svg"
    height="50px"
    style="margin-top: 50px"
  />

  <div class="sub-root">
    <div class="tile-large">
      <h1 style="font-weight: 600;margin-bottom: 0">Dashboard</h1>
      <small class="grey-text">Check all your monthly financial info</small>
      <div
        style="display: flex;flex-direction: row; width: 100%;height: 100%;justify-content: space-evenly;align-items: center;margin-top: 50px">
        <div>
          <img src="assets/income-ico.png" height="60px" width="60px" />
          <div><strong class="grey-text">Balance</strong></div>
          <div class="price-text">{{this.getNumberAsPrice(this.balance)}}</div>
        </div>
        <div>
          <img src="assets/expense-ico.png" height="60px" width="60px" />
          <div><strong class="grey-text">Expense</strong></div>
          <div class="price-text">{{this.getNumberAsPrice(this.monthlyExpense)}}</div>
        </div>
        <div>
          <img src="assets/due-ico.png" height="60px" width="60px" />
          <div><strong class="grey-text">Due</strong></div>
          <div class="price-text">{{this.getNumberAsPrice(this.due)}}</div>
        </div>
      </div>
      <div style="justify-content: space-evenly;display: flex;width: 100%;margin-top: 30px;flex-wrap: wrap">
        <button
          color="primary"
          style="border-radius: 20px"
          mat-raised-button
          (click)="showAddFundsModal()"
        >Add Fund
        </button>
        <button
          color="primary"
          style="border-radius: 20px"
          mat-raised-button
          (click)="showAddExpenseModal()"
        >Add Expense
        </button>
        <button
          color="primary"
          style="border-radius: 20px"
          mat-raised-button
          (click)="showAddDueModal()"
        >Add Due
        </button>
      </div>
    </div>

    <div class="tile-large" style="margin-bottom: 50px;">
      <div style="display: flex; justify-content: space-between">
        <h2 style="font-weight: 600;margin-bottom: 0">Recent Transactions</h2>
        <div style="display: flex;">
          <div
            (click)="dataTableViewMode = 0"
            style="border-radius: 20px 0 0 20px;border-right: none"
            [ngClass]="{'pill-half': true, 'pill-enabled': dataTableViewMode === 0}"
          >
            Fund
          </div>
          <div
            (click)="dataTableViewMode = 1"
            style="border-left: none;border-right: none"
            [ngClass]="{'pill-half': true, 'pill-enabled': dataTableViewMode === 1}"
          >
            Exp
          </div>
          <div
            (click)="dataTableViewMode = 2"
            style="border-radius: 0 20px 20px 0;border-left: none"
            [ngClass]="{'pill-half': true, 'pill-enabled': dataTableViewMode === 2}"
          >
            Due
          </div>
        </div>
      </div>
      <div>
        <table mat-table style="width: 100%" [dataSource]="dataSourceFunds" *ngIf="dataTableViewMode===0">
          <ng-container matColumnDef="createdOn">
            <th mat-header-cell *matHeaderCellDef>Date</th>
            <td mat-cell *matCellDef="let element">{{element.createdOn.toLocaleDateString("en-IN")}}</td>
          </ng-container>

          <ng-container matColumnDef="value">
            <th mat-header-cell *matHeaderCellDef>Amount</th>
            <td mat-cell *matCellDef="let element">{{element.value}}</td>
          </ng-container>

          <ng-container matColumnDef="incomeType">
            <th mat-header-cell *matHeaderCellDef>Category</th>
            <td mat-cell *matCellDef="let element">{{element.incomeType}}</td>
          </ng-container>

          <tr mat-header-row *matHeaderRowDef="displayedIncomeColumns"></tr>
          <tr mat-row *matRowDef="let row; columns: displayedIncomeColumns;"></tr>
        </table>


        <table mat-table style="width: 100%" [dataSource]="dataSourceExpense" *ngIf="dataTableViewMode===1">
          <ng-container matColumnDef="createdOn">
            <th mat-header-cell *matHeaderCellDef>Date</th>
            <td mat-cell *matCellDef="let element">{{element.createdOn.toLocaleDateString("en-IN")}}</td>
          </ng-container>

          <ng-container matColumnDef="value">
            <th mat-header-cell *matHeaderCellDef>Amount</th>
            <td mat-cell *matCellDef="let element">{{element.value}}</td>
          </ng-container>

          <ng-container matColumnDef="expenseType">
            <th mat-header-cell *matHeaderCellDef>Category</th>
            <td mat-cell *matCellDef="let element">{{element.expenseType}}</td>
          </ng-container>

          <ng-container matColumnDef="description">
            <th mat-header-cell *matHeaderCellDef>Description</th>
            <td mat-cell *matCellDef="let element">{{element.description}}</td>
          </ng-container>

          <tr mat-header-row *matHeaderRowDef="displayedExpenseColumns"></tr>
          <tr mat-row *matRowDef="let row; columns: displayedExpenseColumns;"></tr>
        </table>

        <table mat-table style="width: 100%" [dataSource]="dataSourceDues" *ngIf="dataTableViewMode===2">
          <ng-container matColumnDef="createdOn">
            <th mat-header-cell *matHeaderCellDef>Date</th>
            <td mat-cell *matCellDef="let element">{{element.createdOn.toLocaleDateString("en-IN")}}</td>
          </ng-container>

          <ng-container matColumnDef="value">
            <th mat-header-cell *matHeaderCellDef>Amount</th>
            <td mat-cell *matCellDef="let element">{{element.value}}</td>
          </ng-container>

          <ng-container matColumnDef="description">
            <th mat-header-cell *matHeaderCellDef>Description</th>
            <td mat-cell *matCellDef="let element">{{element.description}}</td>
          </ng-container>

          <tr mat-header-row *matHeaderRowDef="displayedDueColumns"></tr>
          <tr mat-row *matRowDef="let row; columns: displayedDueColumns;"></tr>
        </table>
        <div *ngIf="isLoadingExpenseData || isLoadingFundsData || isLoadingDueData"
             style="display: flex; justify-content: center; align-items: center; background: white;">
          <mat-progress-spinner
            mode="indeterminate">
          </mat-progress-spinner>
        </div>
        <mat-paginator
          [pageSizeOptions]="[5, 10, 20]"
          [pageSize]="5"
          [length]="dataTableViewMode===0?dataSourceFunds.data.length:dataTableViewMode===1?dataSourceExpense.data.length:dataSourceDues.data.length"
        ></mat-paginator>
      </div>
    </div>
  </div>
</div>
